---
--- Generated by EmmyLua(https://github.com/EmmyLua)
--- Created by norguhtar.
--- DateTime: 16.09.2019 15:45
---

local pg, _ = pcall(require,"pg")

local postgres = {}

function pg:new(obj)
    obj = obj or {}

    if not pg then
        return nil
    end

    local config = obj.config
    if config then
        self.db = pg.connect({
            host = config.host,
            port = config.port,
            db = config.database,
            user = config.user,
            password = config.password
        })
    end

    setmetatable(obj, self)
    self.__index = self
    return obj
end


function pg:connect()
    local db = self.db

    if db then
        return db
    end
end

function pg:query(sql)
    local db = self.db
    if pg:ping() then
        local res = db:execute(sql)
        if next(res) then
            return res
        end
    end
end

function pg:disconnect()
    local db = self.db
    db:close()
end


return pg